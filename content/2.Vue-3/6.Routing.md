# Routing

## Basic Setup

Öncelikle vue-router projeye dahil edilir.
<br/>
Basit bir router yazalım

```
import { createRouter, createWebHistory } from 'vue-router';

const router = createRouter({
    history: createWebHistory(),
    routes: [
        { path: '/contact', component: ContactView },
        { path: '/about', component: AboutView },
    ],
    linkActiveClass: 'active', // link aktif olunca bu class eklenecek
});

createApp(App)
.use(router)
.mount('#app');
```

1. ```vue-router``` import edilir. createRouter ile history ve routes yazılır.
2. ```.use(router)``` ile projeye dahil edilir.
    ```
    // App.vue
   <template>
         <router-view />
   </template>
    ```
3. App.vue veya main vue dosyası hangisi ise router-view tagı ile dahil etme süreci
   tamamlanır.

## router-link

```
<template>
    <ul>
        <li>
            <router-link to="/about">About</router-link>
        </li>
        <li>
            <router-link to="/contact">Contact</router-link>
        </li>
    </ul>
</template>
```

```<router-link>``` , vue-router özel aracıdır ve url yönlendirmelerinde kullanacağımız etikettir.

1. Routing uyumluluğu: ```router-link``` , Vue Router tarafından sağlanan özel bir
   bileşendir ve Vue Router ile entegrasyonu sağlar. Bu bileşen, tek sayfa
   uygulamalarında gezinti yaparken URL'leri güncellemek için kullanılır. ```router-link```
   kullanmak, sayfa yenilemeleri olmadan uygulama içinde gezinmeyi sağlar ve yolu
   belirtmek için Vue Router'in yönlendirme sistemini kullanır.
2. Otomatik aktif durum: ```router-link``` , geçerli sayfanın URL'si ile ilişkili olduğunda
   otomatik olarak aktif bir duruma geçer. Böylece, gezinme menülerinde veya
   navigasyon bileşenlerinde etkin sayfaları veya etkin bağlantıları vurgulamak için
   kolayca kullanılabilir.
3. Düzgün URL işleme: ```router-link``` , Vue Router tarafından sağlanan URL işleme
   mantığını takip eder ve özel durumlarla başa çıkabilir. Örneğin, parametreleri veya
   sorgu dizelerini içeren URL'leri düzgün bir şekilde işleyebilir ve uygun şekilde URL
   oluşturur.
4. Erişilebilirlik: ```router-link``` , erişilebilirlik standartlarına uygun bir şekilde
   tasarlanmıştır. Bu, klavye erişilebilirliği, ekran okuyucu uyumluluğu ve diğer
   erişilebilirlik faktörlerini desteklemek için gerekli özelliklere sahiptir.

## Styling Active Links

Linkler aktifleşince yani mevcut url ile active-link hedef url’si aynı olduğunda linklerimiz
aktif olmuş olur.

```
const router = createRouter({
    history: createWebHistory(),
    routes: [
        { path: '/contact', component: ContactView },
        { path: '/about', component: AboutView },
    ],
    linkActiveClass: 'active', // link aktif olunca bu class eklenecek
});
```

linkActiveClass ile linkler aktifleşince alacağı class adını belirtebiliriz eğer belirtmezsek
default olarak ```.router-link-active``` ismini alır. Bu şekilde rotaların aktifliğine style
ekleyebiliriz.

## Programmatic Navigation

Kod üzerinden router’a hakim olmak istiyorsak bilmemiz gereken temel fonksiyonlar;

- ```this.$router.push(”/home”)``` → /home adresine gitti.
- ```this.$router.back()``` → Bir önceki sayfaya gitti. (geri)
- ```this.$router.forward()``` → Bir sonraki sayfaya gitti. (ileri)

## Passing Data with Route Params (Dynamic Segments)

URL ile değerleri yakalayabilir ve component içinde bu değerlerle operasyonlar yapabiliriz.

```
<template>
    <div>About View {{ paramId }}</div>
</template>

<script setup lang="ts">
import { useRoute } from 'vue-router';
import { onMounted, ref } from 'vue';

const route = useRoute();
const paramId = ref<any>(null);
    onMounted(() => {
        paramId.value = route.params.id ?? 'NO VALUE!';
        console.log(route.params.id);
    });
</script>
```

## Passing Params as Props

Route parametrelerini komponent içinde props olarak tutabiliriz.
```
const router = createRouter({
   history: createWebHistory(),
   routes: [
      { path: '/contact', component: ContactView },
      { path: '/about/:aboutId', component: AboutView, props: true },
   ],
});
```
Rotamızı oluştururken ```props: true;``` yaparak aslında şunu diyoruz. Biz aboutId
parametresini aslında props olarakta ileteceğiz.
```
const props = defineProps({
   aboutId: {
      type: String,
      reqired: true,
   },
});
```
Ve bu şekilde komponent içinden değerimizi alıoyruz. Komponent içinde ki ve
createRouter içindeki parametre adı aynı olmak zorunda.

## Redirecting & Catch-All Route

1. Rotalarımıza yönlendirmeler ekleyerek hedef url’ye ulaşmak isteyen kullanıcıyı
   belirlediğimiz url’ye yönlendirebiliriz.
2. 404 Not Found sayfası gibi bazı urllerkendinden öncekilerle eşleşmeyen tüm rotaları
   yakalar.
```
const router = createRouter({
   history: createWebHistory(),
   routes: [
      { path: "/", redirect: "/contact" },
      { name: "contact", path: '/contact', component: ContactView },
      { path: '/about/:aboutId', component: AboutView, props: true },
      { path: '/:catchAll(.*)', component: NotFoundView },
   ],
});
```

## Nested Routes

Rotalandırmamızı yaparken çoğu zaman farkederiz ki url adreslerimiz bir noktaya kadar
aynı şekilde gelir. Bunlara nested routes deriz.
```
const router = createRouter({
   history: createWebHistory(),
   routes: [
      { path: "/", redirect: "/contact" },
      { path: '/contact', component: ContactView },
      { path: '/about', component: AboutView, props: true, children: [
         { path: '/:aboutId', component: AboutView, props: true },
      ]
      },
      { path: '/:catchAll(.*)', component: NotFoundView },
   ],
});
```

## Using Query Params

Query parametrelerimizi Vue-Router ile nasıl kontrol set ederiz? Nasıl erişiriz?
<br />
Örnek;
```
💡 https://mysocialapp.com/register/:id?name=Ahmet&surname=Ozdemir
```
1. Bu kullanım linki direkt olarak set etmemizi sağlar.
   ```
   <template>
      <router-link to=`${baseUrl}/register/${linkParams}?${linkQueries}`>
         go login
      </router-link>
   </template>
   ```
2. Bu kullanım için route oluştururken name belirtilmelidir.
   ```
   <template>
      <router-link :to="generateLink">
         go login
      </router-link>
   </template>
   <script setup lang="ts">
   
   const generateLink = () => {
      return {
         name: "register",
         params: {
            registerId: this.id
         },
         query: {
            name: "Ahmet",
            surname: "Özdemir"
         }
      }
   }
   </script>
   ```
3. Fonksiyona dayalı yönlendirmedir.
   ```
   <template>
      <form :submit.prevent="submitFn">
         <!-- Inputlar -->
         <button type="submit">Gönder</button>
      </form>
   </template>
   
   <script setup lang="ts">
   import { useRoute } from 'vue-router';
   const route = useRoute();
   const submitFn = () => {
      // form ile gelen bilgiler işlemden geçtikten sonra
      route.push({
         name: "register",
         params: {
            registerId: this.id
         },
         query: {
            name: "Ahmet",
            surname: "Özdemir"
         }
      });
   }
   </script>
   ```

## Introducing Navigation Guards
```
const router = createRouter({
   history: createWebHistory(),
   routes: [
      { path: '/', redirect: '/contact' },
      { name: 'contact', path: '/contact', component: ContactView },
      { path: '/about/:aboutId', component: AboutView, props: true },
   ],
});
router.beforeEach((to, from, next) => {
   // bazı validasyon işlemleri (auth vs.)
   next(); // yönlendirilmek istenen 'from' sayfasına geçiş izni verir.
   // veya
   next(false); // yönlendirilmek istenen 'from' sayfasına geçiş izni vermez.
});
```
createRouter ile oluşturduğumuz router nesnemiz üzerinden beforeEach ve ilerde
göreceğimiz beforeAfter metotlarımız var. beforeEach’e odaklanacak olursak bu metot
ile sayfa yönlendirmelerinden önce başta authentication olmak üzere sayfa
geçişlerinden yapılacak validasyonların yazıldığı metottur.
Gelelim ```afterEach``` metoduna..
<br/>
```afterEach``` yönlendirme kancası, kullanıcıların hangi sayfalara gittiğini izlemek veya
analitik veri toplamak için kullanılabilir. Örneğin, her bir yönlendirme sonrasında, analitik
servise bir istek göndererek kullanıcının hangi sayfaya gittiğini kaydedebilirsiniz.

## Utilizing Route Metadata

Vue Router'da ```meta``` özelliği, rotalarınızı daha fazla bilgi veya özel yapılandırmalar ile
genişletmek için kullanılan bir özelliktir. ```meta``` özelliği, her bir rotaya ekstra özel alanlar
eklemenizi sağlar ve bu alanları kullanarak özel işlemler yapabilirsiniz.
1. Örneğin beforeEach içinde kullanılabilir.
   ```
   const router = createRouter({
      history: createWebHistory(),
      routes: [
         { path: '/', redirect: '/contact' },
         {
            name: 'contact',
            meta: {
               requiresAuth: true,
               pageTitle: "İletişime Geç!",
            }
            path: '/contact',
            component: ContactView
         },
         { path: '/about/:aboutId', component: AboutView, props: true },
      ],
   });
   
   router.beforeEach( (to, from, next) => {
      if(to.meta.requiresAuth) {
         console.log("Auth is required.");
         next(false);
      }
      next();
      }
   );
   ```
2. Komponent içinde kullanılabilir.
   ```
   <template>
      <div>
         <h1>{{ getPageTitle }}</h1>
         <router-view></router-view>
      </div>
   </template>
   
   <script>
   const getPageTitle = computed(() => {
      return this.$route.meta.pageTitle || 'Sayfa Başlığı';
   });
   </script>
   ```